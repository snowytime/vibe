import React from "react";
import { useFilter } from "../../../hooks/useFilter";
import { useVibeContext } from "../../../../context";

import "./styles.scss";

const DeleteIcon = ({ onClick }: { onClick: () => void }) => (
    <svg
        onClick={onClick}
        height='40%'
        viewBox='0 0 10 10'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'
    >
        <path
            d='M0.649063 9.35237C0.717147 9.41672 0.794687 9.46025 0.881684 9.48296C0.96868 9.50568 1.05568 9.50568 1.14267 9.48296C1.22967 9.46025 1.30532 9.41672 1.36962 9.35237L5.00077 5.7183L8.63193 9.35237C8.69623 9.41672 8.77188 9.46025 8.85887 9.48296C8.94587 9.50568 9.03287 9.50568 9.11986 9.48296C9.21064 9.46404 9.28818 9.4205 9.35248 9.35237C9.41679 9.28801 9.45839 9.2123 9.47731 9.12524C9.5 9.03817 9.5 8.9511 9.47731 8.86404C9.45839 8.77697 9.41679 8.70126 9.35248 8.63691L5.72133 4.99716L9.35248 1.36309C9.41679 1.29874 9.46028 1.22303 9.48298 1.13596C9.50567 1.0489 9.50567 0.96183 9.48298 0.874763C9.46028 0.787697 9.41679 0.711987 9.35248 0.647634C9.2844 0.579495 9.20686 0.535962 9.11986 0.517035C9.03287 0.494322 8.94587 0.494322 8.85887 0.517035C8.77188 0.535962 8.69623 0.579495 8.63193 0.647634L5.00077 4.2817L1.36962 0.647634C1.30532 0.579495 1.22778 0.535962 1.137 0.517035C1.05 0.494322 0.963006 0.494322 0.87601 0.517035C0.789014 0.535962 0.713365 0.579495 0.649063 0.647634C0.584761 0.711987 0.541263 0.787697 0.518568 0.874763C0.499656 0.96183 0.499656 1.0489 0.518568 1.13596C0.541263 1.22303 0.584761 1.29874 0.649063 1.36309L4.28022 4.99716L0.649063 8.63691C0.584761 8.70126 0.541263 8.77697 0.518568 8.86404C0.495874 8.9511 0.493982 9.03817 0.512895 9.12524C0.535589 9.2123 0.580979 9.28801 0.649063 9.35237Z'
            fill='hsl(var(--accent-300))'
        />
    </svg>
);

const SearchIcon = () => (
    <svg height='40%' viewBox='0 0 11 11' fill='none' xmlns='http://www.w3.org/2000/svg'>
        <path
            d='M0 4.44906C0 5.06234 0.116342 5.63845 0.349025 6.17739C0.581708 6.71262 0.904462 7.18466 1.31729 7.59351C1.73011 8.00237 2.20683 8.32201 2.74725 8.55246C3.29143 8.7829 3.87314 8.89812 4.49238 8.89812C4.98026 8.89812 5.44563 8.82379 5.88847 8.67511C6.33132 8.52644 6.73664 8.32201 7.10443 8.06183L9.87411 10.8104C9.94167 10.8736 10.0148 10.9201 10.0937 10.9498C10.1762 10.9833 10.2625 11 10.3526 11C10.4802 11 10.5928 10.9703 10.6904 10.9108C10.788 10.855 10.863 10.777 10.9156 10.6766C10.9719 10.5763 11 10.4648 11 10.3421C11 10.2529 10.9831 10.1693 10.9493 10.0912C10.9193 10.0132 10.8743 9.94442 10.8142 9.88495L8.06144 7.14192C8.35041 6.77023 8.57559 6.3558 8.73697 5.89863C8.9021 5.44146 8.98466 4.95827 8.98466 4.44906C8.98466 3.83578 8.86832 3.26153 8.63564 2.72631C8.40296 2.18736 8.0802 1.71346 7.66738 1.30461C7.25455 0.895759 6.77605 0.576111 6.23187 0.345666C5.69144 0.115222 5.11161 0 4.49238 0C3.87314 0 3.29143 0.115222 2.74725 0.345666C2.20683 0.576111 1.73011 0.895759 1.31729 1.30461C0.904462 1.71346 0.581708 2.18736 0.349025 2.72631C0.116342 3.26153 0 3.83578 0 4.44906ZM0.962633 4.44906C0.962633 3.96587 1.0527 3.51428 1.23285 3.09427C1.41674 2.67055 1.67015 2.29887 1.99291 1.97922C2.31941 1.65585 2.69471 1.40497 3.11879 1.22656C3.54663 1.04443 4.00449 0.953371 4.49238 0.953371C4.98026 0.953371 5.43624 1.04443 5.86033 1.22656C6.28816 1.40497 6.66346 1.65585 6.98621 1.97922C7.30897 2.29887 7.56229 2.67055 7.74619 3.09427C7.93008 3.51428 8.02203 3.96587 8.02203 4.44906C8.02203 4.93225 7.93008 5.38571 7.74619 5.80943C7.56229 6.22943 7.30897 6.59926 6.98621 6.91891C6.66346 7.23855 6.28816 7.48944 5.86033 7.67157C5.43624 7.85369 4.98026 7.94475 4.49238 7.94475C4.00449 7.94475 3.54663 7.85369 3.11879 7.67157C2.69471 7.48944 2.31941 7.23855 1.99291 6.91891C1.67015 6.59926 1.41674 6.22943 1.23285 5.80943C1.0527 5.38571 0.962633 4.93225 0.962633 4.44906Z'
            fill='hsl(var(--accent-300))'
        />
    </svg>
);

export const Search = () => {
    const { search, dispatch } = useVibeContext();

    const setSearch = (value: string) => {
        dispatch({ type: "setSearch", payload: value });
    };

    useFilter(search);

    return (
        <div className='vibe__search'>
            <SearchIcon />
            {search ? <DeleteIcon onClick={() => setSearch("")} /> : null}
            <div className='vibe__search-input'>
                <input
                    value={search}
                    placeholder='search for story...'
                    onChange={(e) => setSearch(e.target.value)}
                    type='text'
                    style={{ width: "max-content" }}
                />
            </div>
        </div>
    );
};
